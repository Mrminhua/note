# 系统原理

# 架构设计


# 设计与实现

## 服务启动

* 1、创建InputManagerService对象，也是核心逻辑
* 2、与WindowManagerService建立关系
* 3、添加到ServiceManager当中
* 4、启动InputManager

```java
inputManager = new InputManagerService(context);
wm = WindowManagerService.main(context, inputManager, !mFirstBoot, mOnlyCore,
        new PhoneWindowManager(), mActivityManagerService.mActivityTaskManager);
ServiceManager.addService(Context.INPUT_SERVICE, inputManager,/* allowIsolated= */ false, DUMP_FLAG_PRIORITY_CRITICAL);
inputManager.setWindowManagerCallbacks(wm.getInputManagerCallback());
inputManager.start();
```
## 事件读取(EventHub&InputReader)

* 1、使用epoll和inotify机制读取节点dev/input

## 事件解析(InputReader)

* 1、

## 事件分发(InputDispatcher)

* 1、


## ANR机制

* 1、


## 问题分析